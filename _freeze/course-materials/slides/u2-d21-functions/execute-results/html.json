{
  "hash": "fffdf3b502aa430920e93650d855d7c8",
  "result": {
    "markdown": "---\ntitle: \"Functions\"\nformat: revealjs\n---\n\n\n# First Minister's COVID speeches\n\n\n::: {.cell}\n\n:::\n\n\n---\n\n## üèÅ Start with\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/fm-speeches.png){width=75%}\n:::\n:::\n\n\n---\n\n## End with üõë {.smaller}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 218 x 6\n   title                                  date       locat~1 abstr~2 text  url  \n   <chr>                                  <date>     <chr>   <chr>   <chr> <chr>\n 1 Coronavirus (COVID-19) update: First ~ 2021-04-20 St And~ Statem~ \"Goo~ http~\n 2 Coronavirus (COVID-19) update: First ~ 2021-04-13 St And~ Statem~ \"Tha~ http~\n 3 Coronavirus (COVID-19) update: First ~ 2021-04-06 St And~ Statem~ \"Goo~ http~\n 4 Coronavirus (COVID-19) update: First ~ 2021-03-30 St And~ Statem~ \"Tha~ http~\n 5 Coronavirus (COVID-19) update: First ~ 2021-03-24 Scotti~ Statem~ \"Tha~ http~\n 6 Coronavirus (Covid-19) update: First ~ 2021-03-23 The Sc~ Statem~ \"Pre~ http~\n 7 Coronavirus (COVID-19) update: First ~ 2021-03-18 Scotti~ Statem~ \"Tha~ http~\n 8 Coronavirus (COVID-19) update: First ~ 2021-03-17 St And~ Statem~ \"\\nG~ http~\n 9 Coronavirus (COVID-19) update: First ~ 2021-03-16 Scotti~ Statem~ \"Pre~ http~\n10 Coronavirus (COVID-19) update: First ~ 2021-03-15 St And~ Statem~ \"\\nG~ http~\n11 Coronavirus (COVID-19) update: First ~ 2021-03-11 Scotti~ Statem~ \"I c~ http~\n12 Coronavirus (COVID-19) update: First ~ 2021-03-09 Scotti~ Statem~ \"Pre~ http~\n13 Coronavirus (COVID-19) update: First ~ 2021-03-05 Scotti~ Parlia~ \"Hel~ http~\n14 Coronavirus (COVID-19) update: First ~ 2021-03-04 Scotti~ Parlia~ \"I w~ http~\n15 Coronavirus (COVID-19) update: First ~ 2021-03-02 Scotti~ Statem~ \"Pre~ http~\n# ... with 203 more rows, and abbreviated variable names 1: location,\n#   2: abstract\n```\n:::\n:::\n\n\n\n---\n\n[www.gov.scot/collections/first-ministers-speeches](https://www.gov.scot/collections/first-ministers-speeche)\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/fm-speeches-annotated.png){width=75%}\n:::\n:::\n\n\n---\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/fm-speech-oct-26-annotated.png){width=65%}\n:::\n:::\n\n\n---\n\n## Plan\n\n1. Scrape `title`, `date`, `location`, `abstract`, and `text` from a few COVID-19 speech pages to develop the code\n\n2. Write a function that scrapes `title`, `date`, `location`, `abstract`, and `text` from COVID-19 speech pages\n\n3. Scrape the `url`s of COVID-19 speeches from the main page\n\n4. Use this function to scrape from each individual COVID-19 speech from these `url`s and create a data frame with the columns `title`, `date`, `location`, `abstract`, `text`, and `url`\n\n# Scrape data from a few COVID-19 speech pages\n\n---\n\n## Read page for 26 Oct speech {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- \"https://www.gov.scot/publications/coronavirus-covid-19-update-first-ministers-speech-26-october/\"\nspeech_page <- read_html(url)\n```\n:::\n\n\n\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nspeech_page\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{html_document}\n<html dir=\"ltr\" lang=\"en\">\n[1] <head>\\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8 ...\n[2] <body class=\"fontawesome site-header__container\">\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n ...\n```\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/fm-speech-oct-26.png){width=80%}\n:::\n:::\n\n:::\n\n::::\n\n\n---\n\n## Extract title\n\n:::: {.columns}\n\n::: {.column width=\"75%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle <- speech_page %>%\n    html_node(\".article-header__title\") %>%\n    html_text()\n\ntitle\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Coronavirus (COVID-19) update: First Minister's speech 26 October\"\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"25%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/title.png){width=100%}\n:::\n:::\n\n:::\n\n::::\n\n\n---\n\n## Extract date {.smaller}\n:::: {.columns}\n\n::: {.column width=\"75%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\n\nspeech_page %>%\n    html_node(\".content-data__list:nth-child(1) strong\") %>%\n    html_text() \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"26 Oct 2020\"\n```\n:::\n\n```{.r .cell-code}\ndate <- speech_page %>%\n    html_node(\".content-data__list:nth-child(1) strong\") %>%\n    html_text() %>%\n    dmy()\ndate\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2020-10-26\"\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"25%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/date.png){width=100%}\n:::\n:::\n\n:::\n\n::::\n\n\n---\n\n## Extract location {.smaller}\n\n:::: {.columns}\n\n::: {.column width=\"75%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code .code-overflow-wrap}\nlocation <- speech_page %>%\n    html_node(\".content-data__list+ .content-data__list strong\") %>%\n    html_text()\n\nlocation\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"St Andrew's House, Edinburgh\"\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"25%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/location.png){width=100%}\n:::\n:::\n\n:::\n\n::::\n\n\n---\n\n## Extract abstract\n\n:::: {.columns}\n\n::: {.column width=\"75%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nabstract <- speech_page %>%\n    html_node(\".leader--first-para p\") %>%\n    html_text()\n\nabstract\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Statement given by First Minister Nicola Sturgeon at a media briefing in St Andrew's House on Monday 26 October 2020.\"\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"25%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/abstract.png){width=100%}\n:::\n:::\n\n:::\n\n::::\n\n\n---\n\n## Extract text\n\n:::: {.columns}\n\n::: {.column width=\"75%\"}\n\n\n::: {.cell output.lines='11'}\n\n```{.r .cell-code}\ntext <- speech_page %>% \n    html_nodes(\"#preamble p\") %>%\n    html_text() %>%\n    list()\n\ntext\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n [1] \"\\r\\nGood afternoon, and thanks for joining us. I want to start with the usual daily report on the COVID statistics.\"                                                                                                                                                                                                                                                                                                                \n [2] \"The total number of positive cases reported yesterday was 1,122.\"                                                                                                                                                                                                                                                                                                                                                                   \n [3] \"This represents 7.1% of the total number of tests carried out. 428 of the new cases were in Greater Glasgow and Clyde, 274 in Lanarkshire, 105 in Lothian and 97 in Ayrshire and Arran.¬†\"                                                                                                                                                                                                                                           \n [4] \"The remaining cases were spread across the mainland health board regions.¬†\"                                                                                                                                                                                                                                                                                                                                                         \n [5] \"The total number of confirmed cases is now 57,874.\"                                                                                                                                                                                                                                                                                                                                                                                 \n [6] \"I can also confirm that 1,152 people are in hospital ‚Äì that is an increase of 36 from yesterday\"                                                                                                                                                                                                                                                                                                                                    \n [7] \"90 people are in intensive care, which is four more than yesterday.\"                                                                                                                                                                                                                                                                                                                                                                \n [8] \"And I regret to say that in the last 24 hours, one further death has been registered of a patient who first tested positive over the previous 28 days.¬† It is important though to remember that registration offices tend not to be open as normal over the weekend so the Sunday and Monday figures are often lower.\"                                                                                                              \n [9] \"We also reported 11 deaths on Saturday, and one yesterday.¬† So since the last briefing on Friday, 13 additional deaths have been registered. That takes the total number of deaths, under this measurement, to 2,701.\"                                                                                                                                                                                                              \n[10] \"That reminds us again of how dangerous this virus can be and I want to send my condolences to everyone who has lost someone.\"                                                                                                                                                                                                                                                                                                       \n[11] \"I am joined by the Cabinet Secretary for Health who will say a few words about the Scottish Government‚Äôs revised testing strategy and about preparations for winter.\"                                                                                                                                                                                                                                                               \n[12] \"Firstly, I will give a brief preview of the week ahead, before updating you on one particular issue.\"                                                                                                                                                                                                                                                                                                                               \n[13] \"On Friday, the Scottish Government published our strategic framework for tackling COVID. The framework includes the proposed levels that will apply to different parts of the country, depending on the prevalence of the virus.\"                                                                                                                                                                                                   \n[14] \"As you recall on Friday we published our strategic framework for tackling COVID.\"                                                                                                                                                                                                                                                                                                                                                   \n[15] \"That framework included the proposed levels that will apply to different parts of the country, depending on prevalence of the virus.\"                                                                                                                                                                                                                                                                                               \n[16] \"Over the weekend, we've discussed the framework with partners and considered further public health advice. These discussions are continuing as are discussions with local councils.\"                                                                                                                                                                                                                                                \n[17] \"There are likely to be some clarifications to the detail of the measures we set out on Friday and so we will publish a revised version, ahead of the parliamentary debate that will take place tomorrow.\"                                                                                                                                                                                                                           \n[18] \"¬†And of course we will keep the detail of the levels under ongoing review as the pandemic develops\"                                                                                                                                                                                                                                                                                                                                 \n[19] \"I will also set out more detail ahead of tomorrow's debate on the factors that will guide decisions on which levels apply to different parts of the country.\"                                                                                                                                                                                                                                                                       \n[20] \"And assuming Parliament agrees the draft framework tomorrow, Ministers will decide later in the week on advice from the national incident management team, and our chief advisors and in consultation with local councils, what levels will initially apply in what parts of the country from Monday November 2.\"                                                                                                                   \n[21] \"And I would remind you that in broad terms, the current restrictions in place in the central belt are equivalent to the proposed level three. And those in the rest of the country, broadly equivalent to level two. So for many places there may be no immediate change.\"                                                                                                                                                          \n[22] \"For an area to come down a level, we want to see a fall in the prevalence of the virus be sustained, not just seen on one or two days.\"                                                                                                                                                                                                                                                                                             \n[23] \"And that I think is important and giving business stability but also in giving people confidence that we are not going to take unnecessary risks when we start to lift restrictions.\"                                                                                                                                                                                                                                               \n[24] \"So the next few days will see some important decisions which of course will have an impact on all of us.\"                                                                                                                                                                                                                                                                                                                           \n[25] \"I think it is important for context for all of us to remember, given how tough all of this is, that these decisions are one that Scotland is facing in common with countries across these islands, across Europe, and of course, across the world. Many countries are facing having to impose or re-impose tough restrictions, especially on hospitality, as a second wave of COVID takes hold.\"                                    \n[26] \"The purpose of adopting tough restrictions just over two weeks ago here was to try to curb the increase in COVID cases that we were seeing before the virus ran further out of control.\"                                                                                                                                                                                                                                            \n[27] \"The daily figures I have been reporting recently as I indicated on Friday¬† suggest that these restrictions are starting to have an effect. We do think that the increase in case numbers is slowing but it's not yet in decline, which is why we can't be complacent, but we should take encouragement from the daily numbers at the moment because they suggest that the sacrifices that everybody is making are starting to work.\"\n[28] \"Once the new five levels approach is adopted and once people get more familiar with it, which I know will take a bit of time, I hope people will be better able to understand, on an ongoing basis the spread of COVID in their particular area, and also what measures are necessary to tackle it.\"                                                                                                                                \n[29] \"Hopefully that in turn will underline a key point. The best way of moving to a lower level of restrictions ‚Äì and of living more freely ‚Äì is to have a lower level of transmission. And the best way we have of driving transmission lower ‚Äì and keeping it low ‚Äì is for all of us to stick to the rules that are in place at any given time. That is of course a collective responsibility for all of us.\"                          \n[30] \"The second point I want to highlight is that two more walk-through testing sites have opened in the last few days.\"                                                                                                                                                                                                                                                                                                                 \n[31] \"On Thursday, a new site opened in the centre of Greenock in Inverclyde, and on Saturday, one opened at the Highland Council headquarters in Inverness.\"                                                                                                                                                                                                                                                                             \n[32] \"That means that in total we have 11 walk-through testing sites now open to meet the needs of local communities across Scotland and to try to make access to testing easier for people.\"                                                                                                                                                                                                                                             \n[33] \"I want to take this opportunity to thank everyone involved in setting up these sites and all those who are helping to run them.\"                                                                                                                                                                                                                                                                                                    \n[34] \"This walk-through centres are only part of our testing infrastructure but they are an important way to make testing more accessible in Scotland‚Äôs towns and cities. So we will continue to work with partners ‚Äì including the UK Government -¬† to establish more of them in the weeks and months ahead..\"                                                                                                                           \n[35] \"It is possible to book a test at a walk-through site by going to the NHS Inform website. Please remember that though they are walk-through sites, you should seek to walk, cycle or drive to them, but do not use public transport to travel to any testing centre.\"                                                                                                                                                                \n[36] \"If you do not have a car - and cannot walk or cycle - please book a home testing kit through NHS Inform.\"                                                                                                                                                                                                                                                                                                                           \n[37] \"The reason for that, is to ensure you do not transmit the virus on the way to or from the testing centre.\"                                                                                                                                                                                                                                                                                                                          \n[38] \"I would remind everybody again that if you experience an of the symptoms of COVID it is really important to self-isolate immediately and take steps to get tested.\"                                                                                                                                                                                                                                                                 \n[39] \"I want to end, as usual, by stressing the other key rules and guidelines.\"                                                                                                                                                                                                                                                                                                                                                          \n[40] \"If you live in Lothian, Lanarkshire, Forth Valley, Ayrshire and Arran and Greater Glasgow and Clyde, you should not travel outside those areas unless you have a clear need to do so.\"                                                                                                                                                                                                                                              \n[41] \"People living in other parts of Scotland should not travel to these areas unless necessary.\"                                                                                                                                                                                                                                                                                                                                        \n[42] \"None of us should be visiting each other‚Äôs homes just now, except for very specific purposes such as childcare or looking after a vulnerable person.\"                                                                                                                                                                                                                                                                               \n[43] \"And when we do meet people from other households - outdoors, or at a caf√© - the maximum group size is 6, from a maximum of two households.\"                                                                                                                                                                                                                                                                                         \n[44] \"Avoid car-sharing if you can. Work from home if you can. And remember to download the Protect Scotland app, if you haven‚Äôt already done so.\"                                                                                                                                                                                                                                                                                        \n[45] \"And finally, remember the FACTS ‚Äì the five rules which will help to remind you how to do the right thing.\"                                                                                                                                                                                                                                                                                                                          \n[46] \"If we all stick to these rules then hopefully the encouraging signs we are seeing in the figures that we are reporting every day will not just continue but accelerate, and a slowing of the increase over the weeks to come will become a decline in the number of daily new cases.\"                                                                                                                                               \n[47] \"Thank you all very much.\"                                                                                                                                                                                                                                                                                                                                                                                                           \n```\n:::\n:::\n\n:::\n\n::: {.column width=\"25%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/text.png){width=100%}\n:::\n:::\n\n:::\n\n::::\n\n\n---\n\n## Put it all in a data frame {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\noct_26_speech <- tibble(\n  title    = title,\n  date     = date,\n  location = location,\n  abstract = abstract,\n  text     = text,\n  url      = url\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noct_26_speech\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 x 6\n  title                                   date       locat~1 abstr~2 text  url  \n  <chr>                                   <date>     <chr>   <chr>   <lis> <chr>\n1 Coronavirus (COVID-19) update: First M~ 2020-10-26 St And~ Statem~ <chr> http~\n# ... with abbreviated variable names 1: location, 2: abstract\n```\n:::\n:::\n\n\n\n---\n\n## Read page for 23 Oct speech {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- \"https://www.gov.scot/publications/coronavirus-covid-19-update-first-ministers-speech-23-october/\"\nspeech_page <- read_html(url)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspeech_page\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{html_document}\n<html dir=\"ltr\" lang=\"en\">\n[1] <head>\\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8 ...\n[2] <body class=\"fontawesome site-header__container\">\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n ...\n```\n:::\n:::\n\n\n---\n\n## Extract components of 23 Oct speech\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle <- speech_page %>%\n  html_node(\".article-header__title\") %>%\n  html_text()\n\ndate <- speech_page %>%\n  html_node(\".content-data__list:nth-child(1) strong\") %>%\n  html_text() %>%\n  dmy()\n\nlocation <- speech_page %>%\n  html_node(\".content-data__list+ .content-data__list strong\") %>%\n  html_text()\n\nabstract <- speech_page %>%\n  html_node(\".leader--first-para p\") %>%\n  html_text()\n\ntext <- speech_page %>%\n  html_nodes(\"#preamble p\") %>%\n  html_text() %>%\n  list()\n```\n:::\n\n\n---\n\n## Put it all in a data frame {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\noct_23_speech <- tibble(\n  title    = title,\n  date     = date,\n  location = location,\n  abstract = abstract,\n  text     = text,\n  url      = url\n)\n\noct_23_speech\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 x 6\n  title                                   date       locat~1 abstr~2 text  url  \n  <chr>                                   <date>     <chr>   <chr>   <lis> <chr>\n1 Coronavirus (COVID-19) update: First M~ 2020-10-23 St And~ Statem~ <chr> http~\n# ... with abbreviated variable names 1: location, 2: abstract\n```\n:::\n:::\n\n\n---\n\n::: aside\nthis is getting tiring...\n::: \n\n# Functions\n\n---\n\n## When should you write a function?\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/funct-all-things.png){width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\nWhen you‚Äôve copied and pasted a block of code more than twice.\n:::\n\n::::\n\n\n---\n\n***How many times will we need to copy and paste the code we developed to scrape data on all of First Minister's COVID-19 speeches?***\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/search-result.png){width=55%}\n:::\n:::\n\n\n---\n\n## Why functions?\n\n- Automate common tasks in a more powerful and general way than copy-and-pasting:\n  - Give your function an evocative name that makes your code easier to understand\n  - As requirements change, only need to update code in one place, instead of many\n  - Eliminate chance of making incidental mistakes when you copy and paste (i.e. updating a variable name in one place, but not in another)\n\n--\n\n- Down the line: Improve your reach as a data scientist by writing functions (and packages!) that others use\n\n---\n\n***Assuming that the page structure is the same for each speech page, how many \"things\" do you need to know for each speech page to scrape the data we want from it?***\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl_23_oct <- \"https://www.gov.scot/publications/coronavirus-covid-19-update-first-ministers-speech-23-october/\"\nspeech_page <- read_html(url_23_oct)\n\ntitle <- speech_page %>%\n  html_node(\".article-header__title\") %>%\n  html_text()\n\ndate <- speech_page %>%\n  html_node(\".content-data__list:nth-child(1) strong\") %>%\n  html_text() %>%\n  dmy()\n\nlocation <- speech_page %>%\n  html_node(\".content-data__list+ .content-data__list strong\") %>%\n  html_text()\n\nabstract <- speech_page %>%\n  html_node(\".leader--first-para p\") %>%\n  html_text()\n\ntext <- speech_page %>%\n  html_nodes(\"#preamble p\") %>%\n  html_text() %>%\n  list()\n\ntibble(\n  title = title, date = date, location = location,\n  abstract = abstract, text = text, url= url\n)\n```\n:::\n\n\n\n---\n\n## Turn your code into a function\n\n- Pick a short but informative **name**, preferably a verb.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech <- \n```\n:::\n\n\n---\n\n## Turn your code into a function\n\n- Pick a short but evocative **name**, preferably a verb.\n- List inputs, or **arguments**, to the function inside `function`. If we had more the call would look like `function(x, y, z)`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech <- function(x){\n  \n  \n  \n  \n  \n}  \n```\n:::\n\n\n---\n\n## Turn your code into a function {.smaller}\n\n- Pick a short but informative **name**, preferably a verb.\n- List inputs, or **arguments**, to the function inside `function`. If we had more the call would look like `function(x, y, z)`.\n- Place the **code** you have developed in body of the function, a `{` block that immediately follows `function(...)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech <- function(url){\n\n  \n  # code we developed earlier to scrape info \n  # on single art piece goes here\n  \n  \n  }\n```\n:::\n\n\n---\n\n## `scrape_speech()` {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech <- function(url) {\n  \n  speech_page <- read_html(url)\n\n  title <- speech_page %>%\n    html_node(\".article-header__title\") %>%\n    html_text()\n\n  date <- speech_page %>%\n    html_node(\".content-data__list:nth-child(1) strong\") %>%\n    html_text() %>%\n    dmy()\n\n  location <- speech_page %>%\n    html_node(\".content-data__list+ .content-data__list strong\") %>%\n    html_text()\n\n  abstract <- speech_page %>%\n    html_node(\".leader--first-para p\") %>%\n    html_text()\n\n  text <- speech_page %>%\n    html_nodes(\"#preamble p\") %>%\n    html_text() %>%\n    list()\n\n  tibble(\n    title = title, date = date, location = location,\n    abstract = abstract, text = text, url = url\n  )\n}\n```\n:::\n\n\n---\n\n## Function in action {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech(url = \"https://www.gov.scot/publications/coronavirus-covid-19-update-first-ministers-speech-26-october/\") %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1\nColumns: 6\n$ title    <chr> NA\n$ date     <date> NA\n$ location <chr> NA\n$ abstract <chr> NA\n$ text     <list> <\"\\nGood afternoon, and thanks for joining us. I want to star~\n$ url      <chr> \"https://www.gov.scot/publications/coronavirus-covid-19-upda~\n```\n:::\n:::\n\n\n---\n \n## Function in action {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech(url = \"https://www.gov.scot/publications/coronavirus-covid-19-update-first-ministers-speech-23-october/\") %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1\nColumns: 6\n$ title    <chr> NA\n$ date     <date> NA\n$ location <chr> NA\n$ abstract <chr> NA\n$ text     <list> <\"\\nGood afternoon everyone. Thank you very much for joining ~\n$ url      <chr> \"https://www.gov.scot/publications/coronavirus-covid-19-upda~\n```\n:::\n:::\n\n\n---\n\n## Function in action {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_speech(url = \"https://www.gov.scot/publications/coronavirus-covid-19-update-first-ministers-speech-22-october/\") %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1\nColumns: 6\n$ title    <chr> NA\n$ date     <date> NA\n$ location <chr> NA\n$ abstract <chr> NA\n$ text     <list> <\"\\nGood afternoon, let me start as usual with the daily repo~\n$ url      <chr> \"https://www.gov.scot/publications/coronavirus-covid-19-upda~\n```\n:::\n:::\n\n\n# Writing functions\n\n---\n\n## What goes in / what comes out? {.smaller}\n\n- They take input(s) defined in the function definition\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfunction([inputs separated by commas]){\n  # what to do with those inputs\n}\n```\n:::\n\n\n- By default they return the last value computed in the function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscrape_page <- function(x){\n  # do bunch of stuff with the input...\n  \n  # return a tibble\n  tibble(...)\n}\n```\n:::\n\n\n- You can define more outputs to be returned in a list as well as nice print methods (but we won't go there for now...)\n\n---\n\n***What is going on here?***\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_2 <- function(x){\n  x + 2\n  1000\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_2(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1000\n```\n:::\n\n```{.r .cell-code}\nadd_2(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1000\n```\n:::\n:::\n\n\n---\n\n## Naming functions\n\n> \"There are only two hard things in Computer Science: cache invalidation and naming things.\" - Phil Karlton\n\n---\n\n## Naming functions\n\n- Names should be short but clearly evoke what the function does\n- Names should be verbs, not nouns\n- Multi-word names should be separated by underscores (`snake_case` as opposed to `camelCase`)\n- A family of functions should be named similarly (`scrape_page()`, `scrape_speech()` OR `str_remove()`, `str_replace()` etc.)\n- Avoid overwriting existing (especially widely used) functions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# JUST DON'T\nmean <- function(x){ \n  x * 3 \n  }\n```\n:::\n",
    "supporting": [
      "u2-d21-functions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}